# SPRING ADVANCED

## ğŸ‘¨â€ğŸ« í”„ë¡œì íŠ¸ ì†Œê°œ
- ì½”ë“œ ê°œì„  ë° **í…ŒìŠ¤íŠ¸ ì½”ë“œ** ì‘ì„±
    - JPA ì‹¬í™” í•™ìŠµê³¼ ê¸°ë³¸ Spring êµ¬ì¡°ì— ëŒ€í•´ ë‹¤ì‹œ í•œ ë²ˆ ë” ë³µìŠµ
    - **í…ŒìŠ¤íŠ¸ ì½”ë“œ** ì‘ì„±ì„ í†µí•´ ê¸°ì¡´ ì½”ë“œì˜ ì•ˆì •ì„± í™•ë³´, ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
    - ì½”ë“œë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê²€ì¦, í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ê¹”ë”í•˜ê²Œ ê´€ë¦¬

---

## â²ï¸ ê°œë°œ ê¸°ê°„
- 2025.06.05(ëª©) ~ 2023.06.12(ìˆ˜)

---

## ğŸ’» ê°œë°œí™˜ê²½
- **Language** : Java 17
- **Framework** : Spring Boot 3.3.3
- **IDE** : IntelliJ
- **Build Tool** : Gradle

---

## âš™ï¸ í”„ë¡œì íŠ¸ ì„¤ëª…
### Lv1.
**1. ì½”ë“œ ê°œì„  í€´ì¦ˆ - Early Return**
- ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ê²½ìš° ì¦‰ì‹œ ë¦¬í„´í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¡œì§ì˜ ì‹¤í–‰ì„ ë°©ì§€í•˜ê³  ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

- íŒ¨í‚¤ì§€ `package org.example.expert.domain.auth.service;` ì˜ `AuthService` í´ë˜ìŠ¤ì— ìˆëŠ” `signup()` ì¤‘ ì•„ë˜ì˜ ì½”ë“œ ë¶€ë¶„ì˜ ìœ„ì¹˜ë¥¼ ë¦¬íŒ©í† ë§í•´ì„œ
```java
if (userRepository.existsByEmail(signupRequest.getEmail())) {
    throw new InvalidRequestException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤.");
}
```

**2. ë¦¬íŒ©í† ë§ í€´ì¦ˆ - ë¶ˆí•„ìš”í•œ if-else í”¼í•˜ê¸°**
- ë³µì¡í•œ if-else êµ¬ì¡°ëŠ” ì½”ë“œì˜ ê°€ë…ì„±ì„ ë–¨ì–´ëœ¨ë¦¬ê³  ìœ ì§€ë³´ìˆ˜ë¥¼ ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ else ë¸”ë¡ì„ ì—†ì•  ì½”ë“œë¥¼ ê°„ê²°í•˜ê²Œ í•©ë‹ˆë‹¤.

- íŒ¨í‚¤ì§€ package org.example.expert.client; ì˜ WeatherClient í´ë˜ìŠ¤ì— ìˆëŠ” getTodayWeather() ì¤‘ ì•„ë˜ì˜ ì½”ë“œ ë¶€ë¶„ì„ ë¦¬íŒ©í† ë§í•´ì£¼ì„¸ìš”.
```java
WeatherDto[] weatherArray = responseEntity.getBody();
if (!HttpStatus.OK.equals(responseEntity.getStatusCode())) {
        throw new ServerException("ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìƒíƒœ ì½”ë“œ: " + responseEntity.getStatusCode());
        } else {
        if (weatherArray == null || weatherArray.length == 0) {
        throw new ServerException("ë‚ ì”¨ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
    }
}
```

**3. ì½”ë“œ ê°œì„  í€´ì¦ˆ - Validation**
- íŒ¨í‚¤ì§€ package org.example.expert.domain.user.service; ì˜ UserService í´ë˜ìŠ¤ì— ìˆëŠ” changePassword() ì¤‘ ì•„ë˜ ì½”ë“œ ë¶€ë¶„ì„ í•´ë‹¹ APIì˜ ìš”ì²­ DTOì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ê°œì„ í•´ì£¼ì„¸ìš”.
```java
if (userChangePasswordRequest.getNewPassword().length() < 8 ||
        !userChangePasswordRequest.getNewPassword().matches("ã……") ||
        !userChangePasswordRequest.getNewPassword().matches(".*[A-Z].*")) {
        throw new InvalidRequestException("ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•˜ê³ , ìˆ«ìì™€ ëŒ€ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.");
}
```
í•´ë‹¹ ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ìƒí™©ì¼ ë•Œ, `passwordEncoder`ì˜ `encode()` ë™ì‘ì´ ë¶ˆí•„ìš”í•˜ê²Œ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ ì½”ë“œë¥¼ ê°œì„ í•´ì£¼ì„¸ìš”.
### Lv2.
**N+1 ë¬¸ì œ**
- `TodoController`ì™€ `TodoService`ë¥¼ í†µí•´ `Todo` ê´€ë ¨ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ì—¬ê¸°ì„œ N+1 ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì‹œë‚˜ë¦¬ì˜¤ëŠ” `getTodos` ë©”ì„œë“œì—ì„œ ëª¨ë“  Todoë¥¼ ì¡°íšŒí•  ë•Œ, ê° Todoì™€ ì—°ê´€ëœ ë°ì´í„°ë¥¼ ê°œë³„ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.
- ìš”êµ¬ì‚¬í•­:
    - JPQL `fetch join`ì„ ì‚¬ìš©í•˜ì—¬ N+1 ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ìˆëŠ” `TodoRepository`ê°€ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë™ì¼í•œ ë™ì‘ì„ í•˜ëŠ” `@EntityGraph` ê¸°ë°˜ì˜ êµ¬í˜„ìœ¼ë¡œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.


### Lv3.
**1. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì—°ìŠµ - 1 (ì˜ˆìƒëŒ€ë¡œ ì„±ê³µí•˜ëŠ”ì§€ì— ëŒ€í•œ ì¼€ì´ìŠ¤ì…ë‹ˆë‹¤.)**
- í…ŒìŠ¤íŠ¸ íŒ¨í‚¤ì§€ package org.example.expert.config; ì˜ PassEncoderTest í´ë˜ìŠ¤ì— ìˆëŠ” matches_ë©”ì„œë“œê°€_ì •ìƒì ìœ¼ë¡œ_ë™ì‘í•œë‹¤() í…ŒìŠ¤íŠ¸ê°€ ì˜ë„ëŒ€ë¡œ ì„±ê³µí•  ìˆ˜ ìˆê²Œ ìˆ˜ì •í•´ ì£¼ì„¸ìš”.

**2. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì—°ìŠµ - 2 (ì˜ˆìƒëŒ€ë¡œ ì˜ˆì™¸ì²˜ë¦¬ í•˜ëŠ”ì§€ì— ëŒ€í•œ ì¼€ì´ìŠ¤ì…ë‹ˆë‹¤.)**
- í…ŒìŠ¤íŠ¸ íŒ¨í‚¤ì§€ package org.example.expert.domain.manager.service; ì˜ ManagerServiceTest ì˜ í´ë˜ìŠ¤ì— ìˆëŠ” manager_ëª©ë¡_ì¡°íšŒ_ì‹œ_Todoê°€_ì—†ë‹¤ë©´_NPE_ì—ëŸ¬ë¥¼_ë˜ì§„ë‹¤() í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ê³  ì»¨í…ìŠ¤íŠ¸ì™€ ì¼ì¹˜í•˜ë„ë¡ í…ŒìŠ¤íŠ¸ ì½”ë“œì™€ í…ŒìŠ¤íŠ¸ ì½”ë“œ ë©”ì„œë“œ ëª…ì„ ìˆ˜ì •í•´ ì£¼ì„¸ìš”.
- í…ŒìŠ¤íŠ¸ íŒ¨í‚¤ì§€ org.example.expert.domain.comment.service; ì˜ CommentServiceTest ì˜ í´ë˜ìŠ¤ì— ìˆëŠ” comment_ë“±ë¡_ì¤‘_í• ì¼ì„_ì°¾ì§€_ëª»í•´_ì—ëŸ¬ê°€_ë°œìƒí•œë‹¤() í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•  ìˆ˜ ìˆë„ë¡ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ìˆ˜ì •í•´ ì£¼ì„¸ìš”.
- í…ŒìŠ¤íŠ¸ íŒ¨í‚¤ì§€ org.example.expert.domain.manager.serviceì˜ ManagerServiceTest í´ë˜ìŠ¤ì— ìˆëŠ” todoì˜_userê°€_nullì¸_ê²½ìš°_ì˜ˆì™¸ê°€_ë°œìƒí•œë‹¤() í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•  ìˆ˜ ìˆë„ë¡ ì„œë¹„ìŠ¤ ë¡œì§ì„ ìˆ˜ì •í•´ ì£¼ì„¸ìš”.

### Lv4.
### Interceptorì™€ AOPë¥¼ í™œìš©í•œ API ë¡œê¹…**

- **í‚¤ì›Œë“œ : Interceptor ë˜ëŠ” AOPë¥¼ í™œìš©í•©ë‹ˆë‹¤.**
- ì–´ë“œë¯¼ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” íŠ¹ì • APIì—ëŠ” ì ‘ê·¼í•  ë•Œë§ˆë‹¤ ì ‘ê·¼ ë¡œê·¸ë¥¼ ê¸°ë¡í•´ì•¼ í•©ë‹ˆë‹¤.

**ìš”êµ¬ì‚¬í•­:**

1. ì–´ë“œë¯¼ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ì˜ˆìš”.
    - `org.example.expert.domain.comment.controller.CommentAdminController` í´ë˜ìŠ¤ì˜ `deleteComment()`
    - `org.example.expert.domain.user.controller.UserAdminController` í´ë˜ìŠ¤ì˜ `changeUserRole()`

**ë¡œê¹… êµ¬í˜„ ë°©ë²•:**

1. **Interceptor**ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•˜ê¸°
    - ìš”ì²­ ì •ë³´(`HttpServletRequest`)ë¥¼ ì‚¬ì „ ì²˜ë¦¬í•©ë‹ˆë‹¤.
    - ì–´ë“œë¯¼ ê¶Œí•œ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì—¬ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ ì°¨ë‹¨í•©ë‹ˆë‹¤.
    - ì¸ì¦ ì„±ê³µ ì‹œ, ìš”ì²­ ì‹œê°ê³¼ URLì„ ë¡œê¹…í•˜ë„ë¡ êµ¬í˜„í•˜ì„¸ìš”.
2. **AOP**ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•˜ê¸°
    - ì–´ë“œë¯¼ API ë©”ì„œë“œ ì‹¤í–‰ ì „í›„ì— ìš”ì²­/ì‘ë‹µ ë°ì´í„°ë¥¼ ë¡œê¹…í•©ë‹ˆë‹¤.
    - ë¡œê¹… ë‚´ìš©ì—ëŠ” ë‹¤ìŒì´ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤:
        - ìš”ì²­í•œ ì‚¬ìš©ìì˜ ID
        - API ìš”ì²­ ì‹œê°
        - API ìš”ì²­ URL
        - ìš”ì²­ ë³¸ë¬¸(`RequestBody`)
        - ì‘ë‹µ ë³¸ë¬¸(`ResponseBody`)
3. **ì„¸ë¶€ êµ¬í˜„ ê°€ì´ë“œ**
    - **Interceptor**:
        - ì–´ë“œë¯¼ ì¸ì¦ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
        - ì¸ì¦ë˜ì§€ ì•Šì€ ê²½ìš° ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.
    - **AOP**:
        - `@Around` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë“œë¯¼ API ë©”ì„œë“œ ì‹¤í–‰ ì „í›„ì— ìš”ì²­/ì‘ë‹µ ë°ì´í„°ë¥¼ ë¡œê¹…í•©ë‹ˆë‹¤.
        - ìš”ì²­ ë³¸ë¬¸ê³¼ ì‘ë‹µ ë³¸ë¬¸ì€ JSON í˜•ì‹ìœ¼ë¡œ ê¸°ë¡í•˜ì„¸ìš”.
    - ë¡œê¹…ì€ `Logger` í´ë˜ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ê¸°ë¡í•©ë‹ˆë‹¤.

